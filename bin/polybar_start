#!/bin/bash

# define the colors file
COLORS_FILE=~/.config/polybar/poly_colors

# get all the colors
# export POLYBAR_TRANSPARENT=$(grep transparent $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_BACKGROUND_00=$(grep bg_0 $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_BACKGROUND_20=$(grep bg_20 $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_BACKGROUND_40=$(grep bg_40 $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_BACKGROUND_60=$(grep bg_60 $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_BACKGROUND_80=$(grep bg_80 $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_BACKGROUND=$(grep "background #" $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_BACKGROUND_DARK=$(grep background-d $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_BACKGROUND_LIGHT=$(grep background-l $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_FOREGROUND=$(grep "foreground #" $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_FOREGROUND_DARK=$(grep foreground-d $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_FOREGROUND_LIGHT=$(grep foreground-l $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_COLOR0=$(grep "color0 #" $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR0_DARK=$(grep color0-d $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR0_LIGHT=$(grep color0-l $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_COLOR1=$(grep "color1 #" $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR1_DARK=$(grep color1-d $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR1_LIGHT=$(grep color1-l $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_COLOR2=$(grep "color2 #" $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR2_DARK=$(grep color2-d $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR2_LIGHT=$(grep color2-l $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_COLOR3=$(grep "color3 #" $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR3_DARK=$(grep color3-d $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR3_LIGHT=$(grep color3-l $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_COLOR4=$(grep "color4 #" $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR4_DARK=$(grep color4-d $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR4_LIGHT=$(grep color4-l $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_COLOR5=$(grep "color5 #" $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR5_DARK=$(grep color5-d $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR5_LIGHT=$(grep color5-l $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_COLOR6=$(grep "color6 #" $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR6_DARK=$(grep color6-d $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR6_LIGHT=$(grep color6-l $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_COLOR7=$(grep "color7 #" $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR7_DARK=$(grep color7-d $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR7_LIGHT=$(grep color7-l $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_COLOR8=$(grep "color8 #" $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR8_DARK=$(grep color8-d $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR8_LIGHT=$(grep color8-l $COLORS_FILE | awk '{print $NF}')

export POLYBAR_TRANSPARENT=#00000000
export POLYBAR_BACKGROUND=#d01d2021
export POLYBAR_BACKGROUND_LIGHT=#504945
export POLYBAR_FOREGROUND=#e0ebdbb2
export POLYBAR_COLOR0=#282828
export POLYBAR_COLOR1=#cc241d
export POLYBAR_COLOR2=#98971a
export POLYBAR_COLOR3=#d79921
export POLYBAR_COLOR4=#458588
export POLYBAR_COLOR5=#b16286
export POLYBAR_COLOR6=#689d6a
export POLYBAR_COLOR7=#a89984

# Terminate already running bar instances
killall -q polybar

# Wait until the processes have been shut down
while pgrep -u $UID -x polybar >/dev/null; do sleep 2; done

# check if multimonitor
if [[ $1 -eq "multi" ]]
then 
    polybar -r top2 &
fi

# Launch bar
polybar -r top &
