#!/bin/bash

# define the colors file
# COLORS_FILE=~/.config/polybar/poly_colors

# get all the colors
# export POLYBAR_TRANSPARENT=$(grep transparent $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_BACKGROUND_00=$(grep bg_0 $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_BACKGROUND_20=$(grep bg_20 $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_BACKGROUND_40=$(grep bg_40 $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_BACKGROUND_60=$(grep bg_60 $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_BACKGROUND_80=$(grep bg_80 $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_BACKGROUND=$(grep "background #" $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_BACKGROUND_DARK=$(grep background-d $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_BACKGROUND_LIGHT=$(grep background-l $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_FOREGROUND=$(grep "foreground #" $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_FOREGROUND_DARK=$(grep foreground-d $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_FOREGROUND_LIGHT=$(grep foreground-l $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_COLOR0=$(grep "color0 #" $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR0_DARK=$(grep color0-d $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR0_LIGHT=$(grep color0-l $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_COLOR1=$(grep "color1 #" $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR1_DARK=$(grep color1-d $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR1_LIGHT=$(grep color1-l $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_COLOR2=$(grep "color2 #" $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR2_DARK=$(grep color2-d $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR2_LIGHT=$(grep color2-l $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_COLOR3=$(grep "color3 #" $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR3_DARK=$(grep color3-d $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR3_LIGHT=$(grep color3-l $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_COLOR4=$(grep "color4 #" $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR4_DARK=$(grep color4-d $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR4_LIGHT=$(grep color4-l $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_COLOR5=$(grep "color5 #" $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR5_DARK=$(grep color5-d $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR5_LIGHT=$(grep color5-l $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_COLOR6=$(grep "color6 #" $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR6_DARK=$(grep color6-d $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR6_LIGHT=$(grep color6-l $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_COLOR7=$(grep "color7 #" $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR7_DARK=$(grep color7-d $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR7_LIGHT=$(grep color7-l $COLORS_FILE | awk '{print $NF}')

# export POLYBAR_COLOR8=$(grep "color8 #" $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR8_DARK=$(grep color8-d $COLORS_FILE | awk '{print $NF}')
# export POLYBAR_COLOR8_LIGHT=$(grep color8-l $COLORS_FILE | awk '{print $NF}')

export POLYBAR_FOREGROUND=#f8f8f2
export POLYBAR_BACKGROUND=#60282a36
export POLYBAR_FONT_FORE=#282a36
export POLYBAR_FONT_BACK=#f8f8f2

# material_orange
export POLYBAR_ORSHADE1=#E65100
export POLYBAR_ORSHADE2=#EF6C00
export POLYBAR_ORSHADE3=#F57C00
export POLYBAR_ORSHADE4=#FB8C00
export POLYBAR_ORSHADE5=#FF9800
export POLYBAR_ORSHADE6=#FFA726
export POLYBAR_ORSHADE7=#FFB74D
export POLYBAR_ORSHADE8=#FFCC80

# material_pink
export POLYBAR_MPSHADE1=#880E4F
export POLYBAR_MPSHADE2=#AD1457
export POLYBAR_MPSHADE3=#C2185B
export POLYBAR_MPSHADE4=#D81B60
export POLYBAR_MPSHADE5=#E91E63
export POLYBAR_MPSHADE6=#EC407A
export POLYBAR_MPSHADE7=#F06292
export POLYBAR_MPSHADE8=#F48FB1

# some of the separators
export POLYBAR_SEPARATOR_R12="%{B$POLYBAR_ORSHADE2}%{F$POLYBAR_ORSHADE1}%{T5}%{T-}%{F-}%{B-}"
export POLYBAR_SEPARATOR_R23="%{B$POLYBAR_ORSHADE3}%{F$POLYBAR_ORSHADE2}%{T5}%{T-}%{F-}%{B-}"
export POLYBAR_SEPARATOR_L12="%{B$POLYBAR_ORSHADE2}%{F$POLYBAR_ORSHADE1}%{T5}%{T-}%{F-}%{B-}"
export POLYBAR_SEPARATOR_L23="%{B$POLYBAR_ORSHADE3}%{F$POLYBAR_ORSHADE2}%{T5}%{T-}%{F-}%{B-}"
export POLYBAR_SEPARATOR_L34="%{B$POLYBAR_ORSHADE4}%{F$POLYBAR_ORSHADE3}%{T5}%{T-}%{F-}%{B-}"
export POLYBAR_SEPARATOR_L45="%{B$POLYBAR_ORSHADE5}%{F$POLYBAR_ORSHADE4}%{T5}%{T-}%{F-}%{B-}"
export POLYBAR_SEPARATOR_L56="%{B$POLYBAR_ORSHADE6}%{F$POLYBAR_ORSHADE5}%{T5}%{T-}%{F-}%{B-}"
export POLYBAR_SEPARATOR_L60="%{B$POLYBAR_BACKGROUND}%{F$POLYBAR_ORSHADE6}%{T5}%{T-}%{F-}%{B-}"

# Terminate already running bar instances
killall -q polybar

# Wait until the processes have been shut down
while pgrep -u $UID -x polybar >/dev/null; do sleep 2; done

# check if multimonitor
if [[ $1 -eq "multi" ]]
then 
    polybar -r top2 &
fi

# Launch bar
polybar -r top & 
