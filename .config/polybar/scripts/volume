#!/bin/bash

# This script is used to detect the current audio sink, so the appropriate icon
# can be selected for the volume module

# getting the colors
iconcolor=$(grep "color6:" ~/.Xdefaults | awk '{print $NF}')
mutecolor=$(grep "color8:" ~/.Xdefaults | awk '{print $NF}')

# the main script
blue=$(pacmd list-sinks | grep -e 'name:' -e 'index:' | grep -A2 \*)

if [[ $blue == *"bluez"* ]]
then
    icon=
    vol=" - "
else
    blue=$(pacmd list-sinks | grep active)
    if [[ $blue == *"headphone"* ]]
    then icon=
    else icon=墳
    fi
    mute=$(pamixer --get-mute)
    if [[ $mute == "false" ]]
    then vol="$(pamixer --get-volume)%"
    else vol="%{F$mutecolor}mute%{F-}"
    fi

fi

echo "%{F$iconcolor}$icon%{F-} $vol"
